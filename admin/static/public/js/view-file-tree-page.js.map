{"version":3,"sources":["webpack:///../website/static/js/pages/view-file-tree-page.js","webpack:///../website/static/js/fileViewTreebeard.js"],"names":[],"mappings":";;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA,CAAC;;;;;;;;AC/BD;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,eAAe;AAClD;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA","file":"view-file-tree-page.js","sourcesContent":["'use strict';\nvar $ = require('jquery');\n\nvar fileBrowser = require('../fileViewTreebeard');\nvar nodeApiUrl = window.contextVars.node.urls.api;\n\n$(document).ready(function() {\n    // Treebeard Files view\n    $.ajax({\n        url: nodeApiUrl + 'files/grid/'\n    })\n    .done(function (data) {\n        new fileBrowser(data);\n        $('#sharebutton').removeClass('disabled');\n    });\n\n    var panelToggle = $('.panel-toggle');\n    var panelExpand = $('.panel-expand');\n    var panelVisible = panelToggle.find('.osf-panel-hide');\n    var panelHidden = panelToggle.find('.osf-panel-show');\n\n    $('.osf-panel-show .tb-header-row').on('click', function () {\n        panelToggle.removeClass('col-sm-1').addClass('col-sm-3');\n        panelExpand.removeClass('col-sm-11').addClass('col-sm-9');\n\n        panelVisible.show();\n        panelHidden.hide();\n    });\n    // TODO: This is a hack to highlight the \"Files\" tab. Rethink.\n    $('.osf-project-navbar li#projectNavFiles').addClass('active');\n\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../website/static/js/pages/view-file-tree-page.js\n ** module id = 0\n ** module chunks = 51\n **/","var Fangorn = require('js/fangorn');\nvar m = require('mithril');\nvar $osf = require('js/osfHelpers');\n\nfunction FileViewTreebeard(data) {\n\n    // Set item.branch to show the branch of the rendered GitHub file instead of the default branch\n    var addonRootFolders = data.data[0].children;\n\n    if (window.contextVars.file.provider === 'github') {\n        for (var i = 0; i < addonRootFolders.length; i++) {\n            var item = addonRootFolders[i];\n            if (item.provider === 'github' && item.isAddonRoot && window.contextVars.file.extra.branch) {\n                item.branch = window.contextVars.file.extra.branch;\n            }\n        }\n    }\n\n    var fangornOpts = {\n        divID: 'grid',\n        filesData: data.data,\n        uploads: false,\n        showFilter: false,\n        title: undefined,\n        hideColumnTitles: true,\n        multiselect : true,\n        placement : 'fileview',\n        allowMove : false,\n        filterTemplate: function () {\n            var tb = this;\n            return m('input.pull-left.form-control[placeholder=\"' + tb.options.filterPlaceholder + '\"][type=\"text\"]', {\n                style: 'width:100%;display:inline;',\n                onkeyup: tb.filter,\n                value: tb.filterText()\n            });\n        },\n        xhrconfig: $osf.setXHRAuthorization,\n        onload: function(tree) {\n            var tb = this;\n            Fangorn.DefaultOptions.onload.call(tb, tree);\n        },\n        ondataload: function () {\n            var tb = this;\n            var path = '';\n            tb.fangornFolderIndex = 0;\n            tb.fangornFolderArray = [''];\n            if (window.contextVars.file.path) {\n                tb.fangornFolderArray = window.contextVars.file.materializedPath.split('/');\n                if (tb.fangornFolderArray.length > 1) {\n                    tb.fangornFolderArray.splice(0, 1);\n                }\n            }\n        },\n        columnTitles: function () {\n            return [{\n                title: 'Name',\n                width: '100%'\n            }];\n        },\n        ontogglefolder : function (tree) {\n            Fangorn.DefaultOptions.ontogglefolder.call(this, tree);\n            var containerHeight = this.select('#tb-tbody').height();\n            if (!this.options.naturalScrollLimit){\n                this.options.showTotal = Math.floor(containerHeight / this.options.rowHeight) + 1;\n            }\n            this.redraw();\n        },\n        lazyLoadOnLoad: function(tree, event) {\n            var tb = this;\n            Fangorn.DefaultOptions.lazyLoadOnLoad.call(tb, tree, event);\n            Fangorn.Utils.setCurrentFileID.call(tb, tree, window.contextVars.node.id, window.contextVars.file);\n            if(!event && tb.isMultiselected(tb.currentFileID)) {\n                Fangorn.Utils.scrollToFile.call(tb, tb.currentFileID);\n            }\n            if (tree.depth > 1) {\n                Fangorn.Utils.orderFolder.call(this, tree);\n            }\n            // if any of the children is the selected add a certain class.\n            for (var i = 0; i < tree.children.length; i++){\n                var item = tree.children[i];\n                if (item.data.kind === 'file' && tb.currentFileID === item.id) {\n                    item.css = 'fangorn-selected';\n                    tb.multiselected([item]);\n                }\n            }\n        },\n        resolveRows: function (item) {\n            var tb = this;\n            var node = item.parent().parent();\n            if(tb.isMultiselected(item.id)) {\n                item.css = 'fangorn-selected';\n            } else {\n                item.css = '';\n            }\n            if(item.data.permissions && !item.data.permissions.view){\n                item.css += ' tb-private-row';\n            }\n            var defaultColumns = [\n                {\n                    data: 'name',\n                    folderIcons: true,\n                    filter: true,\n                    custom: Fangorn.DefaultColumns._fangornTitleColumn\n                }\n            ];\n\n            if (item.parentID) {\n                item.data.permissions = item.data.permissions || item.parent().data.permissions;\n                if (item.data.kind === 'folder') {\n                    item.data.accept = item.data.accept || item.parent().data.accept;\n                }\n            }\n\n            if (item.data.tmpID) {\n                defaultColumns = [\n                    {\n                        data: 'name',  // Data field name\n                        folderIcons: true,\n                        filter: true,\n                        custom: function () {\n                            return m('span.text-muted', 'Uploading ' + item.data.name + '...');\n                        }\n                    }\n                ];\n            }\n\n            var configOption = Fangorn.Utils.resolveconfigOption.call(this, item, 'resolveRows', [item]);\n            return configOption || defaultColumns;\n        }\n    };\n    var filebrowser = new Fangorn(fangornOpts);\n}\n\n\nmodule.exports = FileViewTreebeard;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../website/static/js/fileViewTreebeard.js\n ** module id = 549\n ** module chunks = 51\n **/"],"sourceRoot":""}