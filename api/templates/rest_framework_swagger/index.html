{% extends 'rest_framework_swagger/base.html' %}
{% load staticfiles %}

{% block style %}
    <link href="//fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css"/>
    <link href="{% static 'rest_framework_swagger/css/highlight.default.css' %}" media="screen" rel="stylesheet" type="text/css"/>
    <link href="{% static 'rest_framework_swagger/css/atelier-dune.light.css' %}" media="screen" rel="stylesheet" type="text/css"/>
    <link href="{% static 'rest_framework_swagger/css/osf_rest_framework_swagger.css' %}" media="screen" rel="stylesheet" type="text/css"/>
    <link href="{% static 'rest_framework_swagger/css/osf_screen.css' %}" media="screen" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block branding %}
    <a id="logo" href="http://osf.io">
        <img class="osf-logo" src="{% static 'rest_framework_swagger/images/cos-white2.png' %}" width="27">
        OSF
    </a>
{% endblock %}
{% block api_selector %}
    <form id="api_selector">
        <div class="input"><input placeholder="http://example.com/api" id="input_baseUrl" name="baseUrl" type="text"/></div>
        <div class="input"><input placeholder="api_key" id="input_apiKey" name="apiKey" type="text"/></div>
        <div class="input"><a id="explore" href="#">Explore</a></div>
    </form>
{% endblock %}

{% block scripts %}
    


<script>
(function() {

    var opts;
    var SwaggerRequest__unpatched = SwaggerRequest;

    SwaggerRequest = function(type, url, params, opts, successCallback, errorCallback, operation, execution) {
        console.log(operation);
        console.log(execution);    
     
        var successCallback__unpatched = successCallback;
        successCallback = function(response, opts_parent) {
        
            var ret = successCallback__unpatched(response, opts_parent);
            Array.prototype.filter.call(opts_parent.el.querySelectorAll('.response_body .hljs-string'), function(el) {
                return (
                    el.innerHTML.slice(1, 8) == "http://" ||
                    el.innerHTML.slice(1, 9) == "https://"
                ); 
            }).map(function(el) {
                var url = el.innerHTML.slice(1, -1);
                var anchor = document.createElement("a");
                anchor.textContent = url;
                anchor.href = url;
                var pn = anchor.pathname
                console.log(pn.split('/'))
                console.log(anchor);
                el.innerHTML = "\"<a href=\""+url+"?format=json\">"+url+"</a>"+"\"";
            })
            return ret;
        
        }
        
        SwaggerRequest__unpatched.bind(this)(type, url, params, opts, successCallback, errorCallback, operation, execution);
    
    }
    
})();





</script>
{% endblock %}


